---
/**
 * MoodDigitalCestQuoi.astro
 * Version : CORRECTION BORDURE ANIMÉE (Technique Sandwich)
 */

const {
  id = "mood-cest-quoi",
  eyebrow = "MOODIGITAL.CO",
  title = "Moodigital, c'est un cadre. Pas une checklist.",
  lead = "Ici, on ne te donne pas une checklist. On te reconnecte à ce que tu portes déjà. Moodigital, c'est un espace de transformation business, vibratoire et profond.",
  pillars = [
    {
      title: "Pas de blablas inutiles",
      desc: "On va droit à l'essentiel. Une stratégie simple, nette, actionnable.",
      icon: "gem",
    },
    {
      title: "On avance à ton rythme",
      desc: "Structure, sans pression. Mais sans te laisser fuir.",
      icon: "pulse",
    },
    {
      title: "De l'humain avant tout",
      desc: "Coaching incarné, suivi réel, et un cadre qui tient dans le temps.",
      icon: "star",
    },
  ],
  ctaHref = "#",
  ctaLabel = "Réserve ton appel découverte",
  secondaryHref = "#offres",
  secondaryLabel = "Voir les offres",
} = Astro.props;

const icons = {
  gem: `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M8.2 3.5h7.6c.4 0 .8.2 1 .5l4 6a1.2 1.2 0 0 1-.1 1.5l-8.1 9.6a1.2 1.2 0 0 1-1.8 0L2.8 11.5A1.2 1.2 0 0 1 2.7 10l4-6c.2-.3.6-.5 1-.5Zm.6 2.2L5.5 10h3.3l2-4.3Zm6.4 0L13.2 10h3.3l2.6-4.3Zm-4.5 0L9 10h6l-1.7-4.3Zm-5.1 6.5 6.4 7.6 6.4-7.6H5.6Z"/></svg>`,
  pulse: `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3.5 13.2h3.9l1.3-3.6c.2-.6 1-.6 1.2 0l1.6 5.3 2-6.7c.2-.6 1-.6 1.2 0l1.3 4.9h3.5a1 1 0 1 1 0 2h-4.3c-.5 0-.8-.3-.9-.7l-.5-2-2 6.7c-.2.6-1 .6-1.2 0l-1.6-5.3-.6 1.7c-.1.4-.5.7-.9.7H3.5a1 1 0 1 1 0-2Z"/></svg>`,
  star: `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.5c.4 0 .8.2 1 .6l2.6 5.2 5.7.8c.9.1 1.2 1.2.6 1.8l-4.1 4 1 5.7c.2.9-.8 1.5-1.6 1.1L12 18.9 6.8 21.7c-.8.4-1.8-.2-1.6-1.1l1-5.7-4.1-4c-.6-.6-.3-1.7.6-1.8l5.7-.8 2.6-5.2c.2-.4.6-.6 1-.6Zm0 4 1.7 3.4c.2.3.5.6.9.6l3.7.5-2.7 2.6c-.3.2-.4.6-.3 1l.6 3.7-3.3-1.7a1.1 1.1 0 0 0-1 0l-3.3 1.7.6-3.7c.1-.4-.1-.8-.3-1L5.7 11l3.7-.5c.4 0 .7-.3.9-.6L12 6.5Z"/></svg>`,
};
---

<section id={id} class="mood-section" data-mood-section>
  <div class="mood-noise"></div>
  <div class="mood-bridge" aria-hidden="true"></div>

  <div class="mood-wrap">
    <header class="mood-head">
      <div class="mood-eyebrow reveal">
        <span class="dot" aria-hidden="true"></span>
        <span>{eyebrow}</span>
      </div>
      <h2 class="mood-title reveal"><span set:html={title} /></h2>
      <p class="mood-lead reveal">{lead}</p>
      <div class="mood-actions reveal">
        <a class="btn primary magnetic" href={ctaHref}>
          <span>{ctaLabel}</span>
          <span class="arrow" aria-hidden="true">→</span>
          <span class="btn-shine" aria-hidden="true"></span>
        </a>
        <a class="btn ghost magnetic" href={secondaryHref}>
          <span>{secondaryLabel}</span>
        </a>
      </div>
    </header>

    <div class="mood-grid" role="list">
      {pillars.map((p) => (
        <article class="mood-card reveal" role="listitem">
          <div class="card-border-gradient"></div>
          
          <div class="card-content">
            <div class="card-highlight"></div>
            <div class="icon-wrap">
               <div class="icon" aria-hidden="true" set:html={icons[p.icon] ?? icons.star} />
               <div class="icon-glow"></div>
            </div>
            <h3 class="card-title">{p.title}</h3>
            <p class="card-desc">{p.desc}</p>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>

<script>
  (() => {
    const sections = document.querySelectorAll<HTMLElement>("[data-mood-section]");
    if (!sections.length) return;

    // Observer pour l'apparition
    const io = new IntersectionObserver((entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting) {
          e.target.classList.add("in");
          io.unobserve(e.target);
        }
      });
    }, { threshold: 0.15 });

    sections.forEach((section) => {
      io.observe(section);
      
      // Glow Effect souris (optionnel, désactivable si conflit)
      const finePointer = window.matchMedia("(pointer: fine)").matches;
      if (finePointer) {
        section.addEventListener("pointermove", (e) => {
            const r = section.getBoundingClientRect();
            section.style.setProperty("--mx", `${e.clientX - r.left}px`);
            section.style.setProperty("--my", `${e.clientY - r.top}px`);
        }, { passive: true });
      }
    });
  })();
</script>

<style>
  .mood-section {
    --bg0: #070607;
    --bg1: #0c0a08;
    --text: #f3f3f4;
    --muted: rgba(243, 243, 244, 0.74);
    --cream: #e3dbcf;
    --orange: #e6730a;
    --glass: rgba(255, 255, 255, 0.06);
    --grid: clamp(38px, 6vw, 58px);
    --ease: cubic-bezier(0.16, 1, 0.3, 1);
    --mx: 50%;
    --my: 38%;
    position: relative;
    isolation: isolate;
    overflow: hidden;
    color: var(--text);
    background:
      radial-gradient(1100px 760px at 12% 14%, rgba(187,173,181,0.12), transparent 62%),
      radial-gradient(1200px 820px at 88% 16%, rgba(34,48,38,0.16), transparent 65%),
      linear-gradient(180deg, var(--bg1), var(--bg0));
    margin-top: clamp(-86px, -6vw, -42px);
    padding: clamp(5.2rem, 7.4vw, 6.9rem) 1.25rem clamp(5.4rem, 7vw, 6.9rem);
  }

  .mood-section::before {
    content: "";
    position: absolute;
    inset: -2px;
    background:
      repeating-linear-gradient(0deg, rgba(227,219,207,0.07) 0 1px, transparent 1px var(--grid)),
      repeating-linear-gradient(90deg, rgba(227,219,207,0.07) 0 1px, transparent 1px var(--grid));
    opacity: 0.4;
    mix-blend-mode: soft-light;
    z-index: 0;
    transform: translate3d(0,0,0);
    mask-image: linear-gradient(180deg, transparent 0%, #000 40%, #000 100%);
    -webkit-mask-image: linear-gradient(180deg, transparent 0%, #000 40%, #000 100%);
  }

  .mood-section::after {
    content: "";
    position: absolute;
    inset: 0;
    background:
      radial-gradient(1200px 780px at var(--mx) calc(var(--my) + 60px), rgba(230,115,10,0.12), transparent 62%),
      radial-gradient(900px 640px at 50% 96%, rgba(0,0,0,0.72), transparent 80%);
    pointer-events: none;
    z-index: 1;
  }

  .mood-noise {
    position: absolute;
    inset: 0;
    z-index: 2;
    pointer-events: none;
    opacity: 0.10;
    mix-blend-mode: overlay;
    background-image:
      repeating-radial-gradient(circle at 24% 26%, rgba(255,255,255,0.35) 0 1px, transparent 1px 8px),
      repeating-radial-gradient(circle at 78% 52%, rgba(0,0,0,0.45) 0 1px, transparent 1px 8px);
    filter: blur(0.2px);
  }

  .mood-bridge {
    position: absolute;
    left: 0;
    right: 0;
    top: -160px;
    height: 280px;
    pointer-events: none;
    z-index: 2;
    background:
      linear-gradient(180deg, rgba(7,6,7,0) 0%, rgba(7,6,7,0.65) 55%, rgba(7,6,7,0.95) 85%, rgba(7,6,7,1) 100%),
      radial-gradient(90% 70% at 50% 0%, rgba(7,6,7,0.85), transparent 80%);
  }
  
  .mood-wrap {
    width: min(1040px, 100%);
    margin: 0 auto;
    position: relative;
    z-index: 3;
  }

  .mood-head {
    text-align: center;
    display: grid;
    gap: 0.65rem;
    margin-bottom: clamp(2.2rem, 6vw, 3rem);
  }

  .mood-eyebrow {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.55rem;
    padding: 0.55rem 1rem;
    border-radius: 999px;
    border: 1px solid var(--glass);
    background: rgba(255,255,255,0.03);
    backdrop-filter: blur(12px);
    box-shadow: 0 18px 65px rgba(0,0,0,0.35);
    font-size: 0.84rem;
    letter-spacing: 0.10em;
    text-transform: uppercase;
    color: rgba(227,219,207,0.92);
    margin: 0 auto;
  }

  .dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: var(--orange);
    box-shadow: 0 0 0 6px rgba(230,115,10,0.12);
  }

  .mood-title {
    margin: 0.4rem auto 0;
    max-width: 22ch;
    font-family: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
    font-weight: 820;
    font-size: clamp(2.1rem, 4.8vw, 3.6rem);
    line-height: 1.05;
    letter-spacing: -0.03em;
    background: linear-gradient(135deg, var(--cream) 0%, rgba(230,115,10,0.96) 72%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .mood-lead {
    margin: 0.35rem auto 0;
    max-width: 62ch;
    color: var(--muted);
    font-size: clamp(1.02rem, 2.05vw, 1.18rem);
    line-height: 1.65;
  }

  .mood-actions {
    margin-top: 1.45rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: clamp(0.6rem, 2vw, 0.9rem);
    flex-wrap: wrap;
  }

  .btn {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.65rem;
    padding: clamp(0.82rem, 2.6vw, 0.98rem) clamp(1.05rem, 4.2vw, 1.85rem);
    border-radius: 999px;
    text-decoration: none;
    font-weight: 680;
    border: 1px solid transparent;
    transition: transform 0.35s var(--ease), box-shadow 0.35s var(--ease), background 0.35s var(--ease), border-color 0.35s var(--ease);
    will-change: transform;
    transform: translate3d(0,0,0);
    max-width: 100%;
    min-width: 0;
    box-sizing: border-box;
    font-size: clamp(0.98rem, 2.2vw, 1.05rem);
    line-height: 1.15;
    text-align: center;
    flex-wrap: wrap;
  }

  .primary {
    background: var(--cream);
    color: #0b0a08;
    border-color: rgba(227,219,207,0.78);
    box-shadow: 0 22px 75px rgba(0,0,0,0.45);
    overflow: hidden;
  }

  .ghost {
    background: rgba(255,255,255,0.035);
    color: var(--text);
    border-color: rgba(255,255,255,0.12);
    backdrop-filter: blur(10px);
  }

  .primary:hover { box-shadow: 0 32px 95px rgba(0,0,0,0.58); }

  .ghost:hover {
    border-color: rgba(255,255,255,0.22);
    background: rgba(255,255,255,0.06);
  }

  .arrow {
    display: inline-block;
    transition: transform 0.28s var(--ease);
    flex: 0 0 auto;
  }

  .primary:hover .arrow { transform: translateX(4px); }

  .btn-shine {
    position: absolute;
    inset: -2px;
    pointer-events: none;
    background:
      linear-gradient(115deg,
        transparent 0%,
        rgba(255,255,255,0.00) 38%,
        rgba(255,255,255,0.35) 50%,
        rgba(255,255,255,0.00) 62%,
        transparent 100%
      );
    transform: translateX(-120%);
    opacity: 0.7;
  }

  .primary:hover .btn-shine { animation: shine 0.9s var(--ease) forwards; }

  @keyframes shine { to { transform: translateX(120%); } }

  .mood-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: clamp(1rem, 2.2vw, 1.35rem);
  }

  .mood-card {
    position: relative;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.02);
    backdrop-filter: blur(10px);
    overflow: hidden;
    isolation: isolate;
    transition: transform 0.35s var(--ease), border-color 0.35s var(--ease), box-shadow 0.35s var(--ease);
    box-shadow: 0 18px 55px rgba(0,0,0,0.35);
  }

  .card-border-gradient {
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    background: conic-gradient(
      from 180deg,
      rgba(227,219,207,0.18),
      rgba(230,115,10,0.35),
      rgba(227,219,207,0.12),
      rgba(230,115,10,0.28),
      rgba(227,219,207,0.18)
    );
    opacity: 0.18;
    filter: blur(12px);
    transition: opacity 0.35s var(--ease), transform 0.6s linear;
    z-index: 0;
    pointer-events: none;
  }

  .card-content {
    position: relative;
    z-index: 1;
    padding: 1.35rem 1.25rem 1.4rem;
    display: grid;
    gap: 0.6rem;
  }

  .card-highlight {
    position: absolute;
    top: 0;
    left: 18%;
    right: 18%;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.28), transparent);
    opacity: 0.6;
  }

  .icon-wrap {
    width: 46px;
    height: 46px;
    border-radius: 14px;
    display: grid;
    place-items: center;
    position: relative;
    background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.01));
    border: 1px solid rgba(255,255,255,0.10);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
  }

  .icon {
    width: 22px;
    height: 22px;
    color: #fff;
  }

  .icon :global(svg) { width: 100%; height: 100%; fill: currentColor; }

  .icon-glow {
    position: absolute;
    inset: 0;
    background: var(--orange);
    filter: blur(22px);
    opacity: 0;
    transition: opacity 0.35s var(--ease);
    z-index: 0;
  }

  .card-title {
    margin: 0;
    font-size: 1.05rem;
    font-weight: 700;
    letter-spacing: -0.01em;
    color: var(--text);
  }

  .card-desc {
    margin: 0;
    color: var(--muted);
    line-height: 1.6;
    font-size: 0.98rem;
  }

  .mood-card:hover {
    transform: translateY(-4px);
    border-color: rgba(255,255,255,0.16);
    box-shadow: 0 32px 95px rgba(0,0,0,0.55);
  }

  .mood-card:hover .card-border-gradient { opacity: 0.32; transform: rotate(6deg); }
  .mood-card:hover .icon-glow { opacity: 0.35; }

  /* Reveal */
  .reveal { opacity: 0; transform: translateY(22px); transition: opacity 0.8s var(--ease), transform 0.8s var(--ease); }
  .in .reveal { opacity: 1; transform: translateY(0); }
  .in .mood-eyebrow { transition-delay: 0.1s; }
  .in .mood-title { transition-delay: 0.2s; }
  .in .mood-lead { transition-delay: 0.3s; }
  .in .mood-actions { transition-delay: 0.4s; }
  .in .mood-card:nth-child(1) { transition-delay: 0.5s; }
  .in .mood-card:nth-child(2) { transition-delay: 0.6s; }
  .in .mood-card:nth-child(3) { transition-delay: 0.7s; }

  @media (max-width: 640px) {
    .mood-section { margin-top: -26px; padding-inline: 1rem; }
    .mood-actions { flex-direction: column; align-items: stretch; }
    .btn { width: 100%; }
    .mood-title { font-size: clamp(1.9rem, 7vw, 2.6rem); }
  }

  @media (prefers-reduced-motion: reduce) {
    .reveal { transition: none; opacity: 1; transform: none; }
    .card-border-gradient { transition: none; }
    .mood-card, .btn { transition: none; }
  }
</style>
